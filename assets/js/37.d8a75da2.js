(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{311:function(t,n,s){"use strict";s.r(n);var a=s(14),e=Object(a.a)({},(function(){var t=this,n=t._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"vue2-源码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue2-源码"}},[t._v("#")]),t._v(" vue2 源码")]),t._v(" "),n("blockquote",[n("p",[t._v("vue 的构造函数 instance -> index.js")])]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NODE_ENV")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'production'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("instanceof")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("warn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Vue is a constructor and should be called with the `new` keyword'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_init")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stateMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("eventsMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("lifecycleMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderMixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("h2",{attrs:{id:"注册实例方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#注册实例方法"}},[t._v("#")]),t._v(" 注册实例方法")]),t._v(" "),n("ul",[n("li",[t._v("initMixin\n"),n("ul",[n("li",[t._v("_init 函数的注册")])])]),t._v(" "),n("li",[t._v("stateMixin\n"),n("ul",[n("li",[t._v("为$data 和 $props 添加代理为 _data _props")]),t._v(" "),n("li",[t._v("注册 $set $del $watch 函数")])])]),t._v(" "),n("li",[t._v("eventsMixin\n"),n("ul",[n("li",[t._v("注册 $on $emit $once 等发布订阅的函数")])])]),t._v(" "),n("li",[t._v("lifecycleMixin\n"),n("ul",[n("li",[t._v("注册 _update 函数")])])]),t._v(" "),n("li",[t._v("renderMixin\n"),n("ul",[n("li",[t._v("注册 $nextTick 函数")]),t._v(" "),n("li",[t._v("注册 _render 函数")])])])]),t._v(" "),n("h2",{attrs:{id:"new-vue-做了什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#new-vue-做了什么"}},[t._v("#")]),t._v(" new Vue() 做了什么")]),t._v(" "),n("h3",{attrs:{id:"执行-init-函数-在-initmixin-注册过的"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#执行-init-函数-在-initmixin-注册过的"}},[t._v("#")]),t._v(" 执行 _init() 函数 在 initMixin 注册过的")]),t._v(" "),n("ul",[n("li",[t._v("mergeOptions()\n"),n("ul",[n("li",[t._v("合并 options , 不然 transition keep-alive component 这些组件为什么不用注册就直接能用 全局 direct filter 等被合并")]),t._v(" "),n("li",[t._v("比如 v-show v-model")])])]),t._v(" "),n("li",[t._v("initLifecycle()\n"),n("ul",[n("li",[t._v("$parent $root $children")])])]),t._v(" "),n("li",[t._v("initEvents()\n"),n("ul",[n("li",[t._v("自定义事件 发布订阅 处理组件上的事件监听")])])]),t._v(" "),n("li",[t._v("initRender()\n"),n("ul",[n("li",[t._v("createElement 的初始化")]),t._v(" "),n("li",[t._v("$scopedSlots 的初始化 $slot 的初始化")]),t._v(" "),n("li",[t._v("$attrs $listeners 两个属性被 defineReactive 响应式处理")])])]),t._v(" "),n("li",[t._v("callHook(vm, 'beforeCreate')\n"),n("ul",[n("li",[t._v("触发生命周期 beforeCreate 函数")])])]),t._v(" "),n("li",[t._v("initInjections()\n"),n("ul",[n("li",[t._v("依赖注入 provide 并变为响应式")])])]),t._v(" "),n("li",[t._v("initState()\n"),n("ul",[n("li",[t._v("props > methods > data > computed > watch")]),t._v(" "),n("li",[t._v("会做代理 比如 this.xx 代理为 this._props.xx")]),t._v(" "),n("li",[t._v("深层递归 data 变为响应式，依赖收集")])])]),t._v(" "),n("li",[t._v("initProvide()\n"),n("ul",[n("li",[t._v("初始化_provided 熟悉以便上面的依赖注入使用")])])]),t._v(" "),n("li",[t._v("callHook(vm, 'created')\n"),n("ul",[n("li",[t._v("触发生命周期 created 函数")])])]),t._v(" "),n("li",[t._v("vm.$options.el\n"),n("ul",[n("li",[t._v("如果有 el 则调用 $mount(vm.$options.el) 挂载")])])])])])}),[],!1,null,null,null);n.default=e.exports}}]);