# 一道令人失眠的 promise 题


## 代码执行

```javascript
Promise.resolve().then(() => {
  console.log(0)
  return Promise.resolve(4)
})
Promise.resolve()
  .then(() => {
    console.log(1)
  })
  .then(() => {
    console.log(2)
  })
  .then(() => {
    console.log(3)
  })
  .then(() => {
    console.log(5)
  })
  .then(() => {
    console.log(6)
  })
```

同时执行 结果是 >> 0 1 2 3 4 5 6

## 为什么？

- 如果由多个 promise实例，同时执行链式调用， then会交替执行
- 这是编译器的优化，防止一个promise占据太久时间
- then返回promise实例，相当于多出一个promise实例，也会遵守交替执行，但和直接声明promise实例结果有些差别，会慢两拍