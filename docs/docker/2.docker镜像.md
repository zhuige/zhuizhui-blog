# docker 镜像

### 查看本地镜像

```bash
docker images
或者
docker image ls
```

### 搜索某个镜像

```bash
docker image search [name]
```

### 拉取镜像

```bash
docker image pull [name]
```

### 修改镜像名

```bash
先命名新镜像
docker tag hello-world:latest hello-wrold:v1
然后删除
docker rmi hello-world:latest
```

### 删除镜像

```bash
docker rmi [IMAGE]
或者
docker image rm [IMAGE]
```

### 保存镜像

```bash
docker save -o xxx.tar [IMAGE]
```

### 构建镜像

```bash
docker build -t name:tag [DockerfileDir]
```

### 查看 image hisory 构建信息

```bash
docker history [IMAGE]
```

### 查看 image 详细信息

```bash
docker image inspect [IMAGE]
```

### 推送镜像到自己的 docker hub

```bash
先登录docker hub
docker login
docker push zhuige/name:tag
```

### Dockerfile

例子

```
# 使用node环境的操作系统
FROM node:17.4.0-alpine3.15

# 指定容器内的工作目录
WORKDIR /app

# 复制当前所有文件到容器/app里面
COPY . /app

#暴露出去的端口号
EXPOSE 3000

# 启动容器时运行的命令
CMD node ./index.js
```

- FROM 使用哪个基础镜像 scratch 是 base image
- LABEL 指令用来给镜像添加一些元数据
  LABEL org.opencontainers.image.authors="zhuizhui"
- WORKDIR 指定工作目录
- COPY 复制文件到 xx 目录
- ADD 添加文件到 xx 目录，类似 COPY,但 ADD 还提供解压缩功能
- VOLUME <路径> 数据卷映射
- RUN xx 构建过程中运行的命令
- EXPOSE 3000 暴露 3000 端口号出去给宿主机用
- ENV <key1>=<value1> 环境变量
- VOLUME ["<路径 1>", "<路径 2>"...] 定义匿名数据卷。在启动容器时忘记挂载数据卷，会自动挂载到匿名卷。
- ARG 跟 ENV 差不多，但只在 build 阶段有效，而 ENV 在容器启动都有效
- ENTRYPOINT 类似于 CMD 指令，但其不会被 docker run 的命令行参数指定的指令所覆盖，而且这些命令行参数会被当作参数送给 ENTRYPOINT 指令指定的程序。只能有一个
- CMD 容器启动后默认运行的命令 只能有一个
